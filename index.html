<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ï∫òÎ¶∞Îçî">
    <meta name="theme-color" content="#3b82f6">
    <title>AI Ï∫òÎ¶∞Îçî ÎπÑÏÑú</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Jua&family=Nanum+Pen+Script&family=Inter:wght@400;600&family=Roboto:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css?v=67">
    <script src="lib/chrono.min.js"></script>
</head>

<body>
    <div class="background-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <div class="container">
        <!-- Title Row -->
        <div class="title-row">
            <h2 id="app-title">MANAGE SCHEDULE APP</h2>
        </div>

        <!-- Category Row (hidden on main) -->
        <div id="category-row" class="category-row" style="display: none;">
            <!-- Chips will be generated by JS -->
        </div>

        <input type="color" id="event-color-input" value="#3b82f6" style="display: none;">


        <!-- Appearance Settings (New Row) -->
        <div class="appearance-row" style="display: flex; justify-content: flex-end; margin-bottom: 0.5rem;">
            <button id="btn-appearance" class="btn-icon-large" title="Appearance"
                style="background: none; border: none; padding: 0;">
                <img src="assets/icon-appearance.png" alt="Appearance" style="width: 32px; height: 32px;">
            </button>
        </div>

        <!-- Input -->
        <div class="input-row">
            <div class="input-wrapper">
                <textarea id="input-text" placeholder="ÏùºÏ†ï ÏûÖÎ†•"></textarea>
                <button id="btn-quick-add" class="btn-icon btn-quick-add" title="ÏùºÏ†ï Ï∂îÍ∞Ä">
                    <span>+</span>
                </button>
            </div>
            <button id="btn-voice-input" class="btn-icon btn-voice" title="ÏùåÏÑ± ÏûÖÎ†•">
                <img src="voice-icon.png" alt="ÏùåÏÑ± ÏûÖÎ†•" class="voice-icon">
                <span class="listening-indicator">Îì£Îäî Ï§ë...</span>
            </button>
            <!-- Diary Toggle Button (Moved here) -->
            <button id="btn-diary-toggle" class="btn-icon-large" title="Îã§Ïù¥Ïñ¥Î¶¨ Íæ∏ÎØ∏Í∏∞"
                style="background: none; border: none; padding: 0; margin-left: 0.5rem;">
                <img src="assets/icon-diary-toggle.png" alt="Diary" style="width: 48px; height: 48px;">
            </button>
        </div>

        <div id="parsing-feedback" class="parsing-feedback"></div>

        <!-- Tabs -->
        <div class="tab-container">
            <button id="tab-calendar" class="tab-btn active">Îã¨Î†•</button>
            <button id="tab-list" class="tab-btn">ÏùºÏ†ïÎ™©Î°ù</button>
        </div>

        <!-- Calendar -->
        <section class="calendar-section" id="calendar-section">
            <div class="calendar-header">
                <button id="prev-month">‚óÄ</button>
                <h2 id="current-month-year">2023ÎÖÑ 12Ïõî</h2>
                <button id="next-month">‚ñ∂</button>
            </div>
            <div class="calendar-grid" id="calendar-grid">
                <!-- Days will be generated here -->
            </div>
        </section>

        <!-- Diary Section (Hidden by default) -->
        <section class="diary-section hidden" id="diary-section">
            <!-- Diary Cover for Animation -->
            <div id="diary-cover" class="diary-cover hidden">
                <div class="diary-cover-front">
                    <!-- Empty cover, no text -->
                </div>
            </div>

            <div class="diary-header" style="justify-content: space-between; align-items: center; position: relative;">
                <button id="btn-diary-back" class="btn-icon-small" title="ÎèåÏïÑÍ∞ÄÍ∏∞"
                    style="background: none; border: none; padding: 0;">
                    <img src="assets/icon-calendar-back.png" alt="Back" style="width: 32px; height: 32px;">
                </button>

                <div class="diary-nav"
                    style="position: absolute; left: 50%; transform: translateX(-50%); display: flex; align-items: center; gap: 1rem;">
                    <button id="diary-prev-day" class="btn-text">‚óÄ</button>
                    <h2 id="diary-date-title" style="margin: 0; font-size: 1.5rem;">2023ÎÖÑ 12Ïõî 1Ïùº</h2>
                    <button id="diary-next-day" class="btn-text">‚ñ∂</button>
                </div>

                <button id="btn-diary-settings" class="btn-icon-small" title="Îã§Ïù¥Ïñ¥Î¶¨ ÏÑ§Ï†ï">‚öôÔ∏è</button>
            </div>
            <div class="diary-paper" id="diary-paper">
                <div class="diary-background" id="diary-background"></div>
                <canvas id="diary-canvas"></canvas>
                <div id="diary-content-layer"></div>
            </div>

            <!-- Pen Settings (Visible when Pen is active) -->
            <div id="pen-settings" class="pen-settings hidden">
                <div class="pen-setting-row">
                    <input type="color" id="pen-color" value="#000000">
                    <input type="range" id="pen-width" min="1" max="20" value="2">
                    <button id="tool-eraser" class="btn-icon-small" title="ÏßÄÏö∞Í∞ú">üßπ</button>
                </div>
            </div>

            <div class="diary-toolbar">
                <button class="tool-btn" id="tool-photo">ÏÇ¨ÏßÑÏóÖÎ°úÎìú</button>
                <button class="tool-btn" id="tool-sticker">Ïù¥Î™®Ìã∞ÏΩò</button>
                <button class="tool-btn" id="tool-text">Í∏ÄÏûê</button>
                <button class="tool-btn" id="tool-pen">Í∑∏Î¶¨Í∏∞</button>
                <button class="tool-btn" id="btn-settings-share"
                    style="display: flex; align-items: center; justify-content: center; gap: 5px;">
                    <img src="assets/icon-share.png" alt="Share" style="width: 20px; height: 20px;">
                    Í≥µÏú†
                </button>
            </div>

            <input type="file" id="photo-input" accept="image/*" style="display: none;">

            <!-- Diary Settings Modal -->
            <div id="diary-settings-modal" class="modal hidden">
                <div class="modal-content glass-container" style="max-width: 360px;">
                    <span id="close-diary-settings" class="close">&times;</span>
                    <h2>Îã§Ïù¥Ïñ¥Î¶¨ ÏÑ§Ï†ï</h2>

                    <div class="form-group">
                        <label>ÏÜçÏßÄ ÌÉÄÏûÖ</label>
                        <select id="diary-paper-type" class="date-select">
                            <option value="lined">Ï§Ñ Í≥µÏ±Ö (Wide)</option>
                            <option value="lined-narrow">Ï§Ñ Í≥µÏ±Ö (Narrow)</option>
                            <option value="grid">Î™®ÎààÏ¢ÖÏù¥</option>
                            <option value="dot">Ï†êÏÑ† (Dot)</option>
                            <option value="plain">Îπà Ï¢ÖÏù¥</option>
                            <option value="kraft">ÌÅ¨ÎùºÌîÑÌä∏ÏßÄ</option>
                            <option value="dark">Îã§ÌÅ¨ Î™®Îìú</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ÏÜçÏßÄ ÏÉâÏÉÅ</label>
                        <input type="color" id="diary-paper-color" value="#fdfbf7"
                            style="width: 100%; height: 40px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);">
                    </div>

                    <!-- Preview Area -->
                    <div class="form-group">
                        <label>ÎØ∏Î¶¨Î≥¥Í∏∞</label>
                        <div id="diary-preview"
                            style="width: 100%; height: 150px; border: 1px solid #ccc; border-radius: 8px; position: relative; overflow: hidden;">
                            <div id="diary-preview-bg" style="width: 100%; height: 100%;"></div>
                        </div>
                    </div>

                    <div class="modal-actions" style="margin-top: 20px;">
                        <button id="btn-settings-confirm" class="btn-primary" style="width: 100%;">ÌôïÏù∏</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Event List -->
        <section class="event-list-section hidden" id="event-list-section">
            <div id="event-list-container">
                <!-- Events will be populated here -->
            </div>
        </section>

        <!-- Sync Button (moved below calendar) -->
        <button id="btn-open-sync" class="btn btn-sync-bottom">ÎèôÍ∏∞Ìôî</button>

        </main>

        <!-- Event Modal -->
        <div id="event-modal" class="modal hidden">
            <div class="modal-content glass-container">
                <span id="close-modal" class="close">&times;</span>
                <h2 id="modal-title">ÏùºÏ†ï ÏÉÅÏÑ∏</h2>

                <div class="form-group">
                    <label>Ï†úÎ™©</label>
                    <input type="text" id="edit-title">
                </div>

                <div class="form-group">
                    <label>Category</label>
                    <div class="color-picker-wrapper">
                        <input type="color" id="edit-color" style="visibility: hidden; position: absolute;">
                        <span id="color-preview-text" style="display:none;"></span>
                        <div id="modal-color-palette" class="color-palette" style="margin-left: 0;"></div>
                    </div>
                </div>

                <div class="form-group">
                    <div
                        style="margin-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: center;">
                        <label
                            style="display: inline-flex; align-items: center; gap: 0.2rem; cursor: pointer; writing-mode: horizontal-tb;">
                            <input type="checkbox" id="edit-all-day" style="width: 16px; height: 16px; margin: 0;">
                            <span
                                style="writing-mode: horizontal-tb; white-space: nowrap; display: inline-block;">Ï¢ÖÏùº</span>
                        </label>
                        <label
                            style="display: inline-flex; align-items: center; gap: 0.2rem; cursor: pointer; writing-mode: horizontal-tb;">
                            <input type="checkbox" id="edit-reminder-enabled"
                                style="width: 16px; height: 16px; margin: 0;">
                            <span
                                style="writing-mode: horizontal-tb; white-space: nowrap; display: inline-block;">ÎØ∏Î¶¨ÏïåÎ¶º</span>
                        </label>
                    </div>
                    <div class="date-range-inputs"
                        style="display: flex; flex-direction: column; gap: 0.5rem; padding: 0 0.5rem;">
                        <input type="datetime-local" id="edit-start" class="datetime-input" style="width: 100%;">
                        <input type="datetime-local" id="edit-end" class="datetime-input" style="width: 100%;">
                    </div>
                </div>

                <div class="form-group">
                    <label>ÏÑ§Î™Ö</label>
                    <textarea id="edit-desc" rows="2"></textarea>
                </div>

                <div class="modal-actions">
                    <button id="modal-btn-cancel" class="btn btn-secondary">Ï∑®ÏÜå</button>
                    <button id="modal-btn-save" class="btn btn-success">Ï†ÄÏû•</button>
                    <button id="modal-btn-delete" class="btn btn-danger">ÏÇ≠Ï†ú</button>
                </div>
            </div>
        </div>

        <!-- Device Selection Modal -->
        <div id="device-modal" class="modal hidden">
            <div class="modal-content device-modal-content">
                <h2>Í∏∞Í∏∞ ÏÑ†ÌÉù</h2>
                <p>ÏÇ¨Ïö© Ï§ëÏù∏ Í∏∞Í∏∞Î•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.</p>
                <div class="device-list">
                    <button class="device-btn" data-device="iphone-16-pro">
                        <span class="device-icon">üì±</span>
                        <span class="device-name">iPhone 16 Pro</span>
                    </button>
                    <!-- Add more devices later -->
                </div>

                <button id="close-device-modal" class="btn-text">Îã´Í∏∞</button>
            </div>
        </div>

        <!-- Appearance Settings Modal -->
        <div id="appearance-modal" class="modal hidden">
            <div class="modal-content glass-container"
                style="max-width: 360px; display: flex; flex-direction: column; max-height: 80vh; padding: 0;">

                <!-- Header (Fixed) -->
                <div
                    style="padding: 1.5rem 1.5rem 1rem 1.5rem; border-bottom: 1px solid var(--glass-border); display: flex; justify-content: space-between; align-items: center;">
                    <h2 style="margin: 0;">Appearance</h2>
                    <span id="close-appearance" class="close" style="position: static; line-height: 1;">&times;</span>
                </div>

                <!-- Scrollable Body -->
                <div style="overflow-y: auto; padding: 1.5rem; flex: 1;">
                    <div class="form-group">
                        <label>Theme</label>
                        <div style="display: flex; gap: 10px;">
                            <button id="theme-light" class="btn-secondary" style="flex: 1;">Light</button>
                            <button id="theme-dark" class="btn-secondary" style="flex: 1;">Dark</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>UI Font</label>
                        <select id="ui-font" class="date-select">
                            <option value="'Jua', sans-serif">Jua (Default)</option>
                            <option value="'Nanum Pen Script', cursive">Nanum Pen Script</option>
                            <option value="'BMJUA', cursive">BMJUA</option>
                            <option value="'Roboto', sans-serif">Roboto</option>
                            <option value="'Inter', sans-serif">Inter</option>
                        </select>
                    </div>



                    <div class="form-group">
                        <label>Tabs (Calendar/List)</label>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn-secondary fs-btn" data-target="fs-tabs" data-value="12"
                                style="flex: 1;">S</button>
                            <button class="btn-secondary fs-btn" data-target="fs-tabs" data-value="16"
                                style="flex: 1;">M</button>
                            <button class="btn-secondary fs-btn" data-target="fs-tabs" data-value="20"
                                style="flex: 1;">L</button>
                            <button class="btn-secondary fs-btn" data-target="fs-tabs" data-value="24"
                                style="flex: 1;">XL</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>App Title</label>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn-secondary fs-btn" data-target="fs-app-title" data-value="20"
                                style="flex: 1;">S</button>
                            <button class="btn-secondary fs-btn" data-target="fs-app-title" data-value="24"
                                style="flex: 1;">M</button>
                            <button class="btn-secondary fs-btn" data-target="fs-app-title" data-value="28"
                                style="flex: 1;">L</button>
                            <button class="btn-secondary fs-btn" data-target="fs-app-title" data-value="32"
                                style="flex: 1;">XL</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Calendar Header</label>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn-secondary fs-btn" data-target="fs-cal-header" data-value="12"
                                style="flex: 1;">S</button>
                            <button class="btn-secondary fs-btn" data-target="fs-cal-header" data-value="16"
                                style="flex: 1;">M</button>
                            <button class="btn-secondary fs-btn" data-target="fs-cal-header" data-value="20"
                                style="flex: 1;">L</button>
                            <button class="btn-secondary fs-btn" data-target="fs-cal-header" data-value="24"
                                style="flex: 1;">XL</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Calendar Events</label>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn-secondary fs-btn" data-target="fs-cal-events" data-value="10"
                                style="flex: 1;">S</button>
                            <button class="btn-secondary fs-btn" data-target="fs-cal-events" data-value="12"
                                style="flex: 1;">M</button>
                            <button class="btn-secondary fs-btn" data-target="fs-cal-events" data-value="14"
                                style="flex: 1;">L</button>
                            <button class="btn-secondary fs-btn" data-target="fs-cal-events" data-value="16"
                                style="flex: 1;">XL</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Calendar Dates</label>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn-secondary fs-btn" data-target="fs-cal-date" data-value="12"
                                style="flex: 1;">S</button>
                            <button class="btn-secondary fs-btn" data-target="fs-cal-date" data-value="16"
                                style="flex: 1;">M</button>
                            <button class="btn-secondary fs-btn" data-target="fs-cal-date" data-value="20"
                                style="flex: 1;">L</button>
                            <button class="btn-secondary fs-btn" data-target="fs-cal-date" data-value="24"
                                style="flex: 1;">XL</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>List View Headers</label>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn-secondary fs-btn" data-target="fs-list-header" data-value="14"
                                style="flex: 1;">S</button>
                            <button class="btn-secondary fs-btn" data-target="fs-list-header" data-value="18"
                                style="flex: 1;">M</button>
                            <button class="btn-secondary fs-btn" data-target="fs-list-header" data-value="22"
                                style="flex: 1;">L</button>
                            <button class="btn-secondary fs-btn" data-target="fs-list-header" data-value="24"
                                style="flex: 1;">XL</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>List View Content</label>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn-secondary fs-btn" data-target="fs-list-content" data-value="12"
                                style="flex: 1;">S</button>
                            <button class="btn-secondary fs-btn" data-target="fs-list-content" data-value="16"
                                style="flex: 1;">M</button>
                            <button class="btn-secondary fs-btn" data-target="fs-list-content" data-value="20"
                                style="flex: 1;">L</button>
                            <button class="btn-secondary fs-btn" data-target="fs-list-content" data-value="24"
                                style="flex: 1;">XL</button>
                        </div>
                    </div>
                </div>

                <!-- Footer (Fixed) -->
                <div class="modal-actions"
                    style="padding: 1rem 1.5rem; border-top: 1px solid var(--glass-border); margin-top: 0;">
                    <button id="btn-appearance-save" class="btn-primary" style="width: 100%;">Save</button>
                </div>
            </div>
        </div>

        <!-- Day Detail Modal -->
        <div id="day-detail-modal" class="modal hidden">
            <div class="modal-content day-detail-content">
                <span id="close-day-detail" class="close">&times;</span>
                <h2 id="day-detail-date"></h2>
                <div id="day-detail-list" class="day-detail-list">
                    <!-- Events will be populated here -->
                </div>
                <button id="btn-add-event-bottom" class="btn btn-primary btn-add-bottom">
                    + ÏùºÏ†ï Ï∂îÍ∞Ä
                </button>
            </div>
        </div>
    </div>

    <!-- Category Creation Modal -->
    <div id="category-modal" class="modal hidden">
        <div class="modal-content glass-container" style="max-width: 320px;">
            <span id="close-category-modal" class="close">&times;</span>
            <h2>ÏÉà Ïπ¥ÌÖåÍ≥†Î¶¨ Ï∂îÍ∞Ä</h2>

            <div class="form-group">
                <label>Ïπ¥ÌÖåÍ≥†Î¶¨ Ïù¥Î¶Ñ</label>
                <input type="text" id="new-category-name" placeholder="Ïòà: ÎèÖÏÑú, Í≤åÏûÑ, Îç∞Ïù¥Ìä∏">
            </div>

            <div class="form-group">
                <label>ÏÉâÏÉÅ ÏÑ†ÌÉù</label>
                <div id="recommended-colors-grid" class="color-grid">
                    <!-- Colors will be injected here -->
                </div>
            </div>

            <button id="btn-category-save" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">Ï†ÄÏû•</button>
        </div>
    </div>

    <!-- Year/Month Picker Modal -->
    <div id="date-picker-modal" class="modal hidden">
        <div class="modal-content glass-container" style="max-width: 280px;">
            <span id="close-date-picker" class="close">&times;</span>
            <h2>ÎÇ†Ïßú ÏÑ†ÌÉù</h2>

            <div class="form-group">
                <label>ÎÖÑÎèÑ</label>
                <select id="year-select" class="date-select">
                    <!-- Years will be populated by JS -->
                </select>
            </div>

            <div class="form-group">
                <label>Ïõî</label>
                <select id="month-select" class="date-select">
                    <option value="0">1Ïõî</option>
                    <option value="1">2Ïõî</option>
                    <option value="2">3Ïõî</option>
                    <option value="3">4Ïõî</option>
                    <option value="4">5Ïõî</option>
                    <option value="5">6Ïõî</option>
                    <option value="6">7Ïõî</option>
                    <option value="7">8Ïõî</option>
                    <option value="8">9Ïõî</option>
                    <option value="9">10Ïõî</option>
                    <option value="10">11Ïõî</option>
                    <option value="11">12Ïõî</option>
                </select>
            </div>

            <button id="btn-date-picker-apply" class="btn btn-primary"
                style="width: 100%; margin-top: 1rem;">Ï†ÅÏö©</button>
        </div>
    </div>
    </div>

    <!-- Reminder Time Picker Modal -->
    <div id="reminder-picker-modal" class="modal hidden">
        <div class="modal-content glass-container" style="max-width: 320px;">
            <span id="close-reminder-picker" class="close">&times;</span>
            <h2>ÎØ∏Î¶¨ÏïåÎ¶º ÏÑ§Ï†ï</h2>

            <div class="dial-picker-container">
                <div class="dial-column">
                    <div class="dial-label">Ïùº</div>
                    <div class="dial-scroll" id="dial-days">
                        <!-- 0-30Ïùº -->
                    </div>
                </div>
                <div class="dial-column">
                    <div class="dial-label">Ïãú</div>
                    <div class="dial-scroll" id="dial-hours">
                        <!-- 0-23Ïãú -->
                    </div>
                </div>
                <div class="dial-column">
                    <div class="dial-label">Î∂Ñ</div>
                    <div class="dial-scroll" id="dial-minutes">
                        <!-- 0, 15, 30, 45Î∂Ñ -->
                    </div>
                </div>
            </div>

            <button id="btn-reminder-save" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">Ï†ÄÏû•</button>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Scripts -->
    <script src="app.js?v=73" defer></script>

    <script src="https://apis.google.com/js/api.js" onload="gapiLoaded()" async defer></script>
    <script src="https://accounts.google.com/gsi/client" onload="gisLoaded()" async defer></script>
</body>

</html>